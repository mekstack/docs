Quick Start
===========

В этом разделе описан процесс создания виртуалки, подключения к VPN и настройки
форварда HTTPS на неё с нуля.

Если что-то не понятно: :doc:`faq`.

Веб дашборд
-----------

Тык -> `mekstack.ru <https://mekstack.ru>`_.

При входе автоматически создадутся проекты, в которых ты состоишь.
Переключаться между ними можно через дропдаун-меню слева сверху.

Запуск Виртуалочки
------------------

..
    .. note::

       Тыкание кнопок в гуях можно пропустить и сразу раздеплоить инфру терраформом.
       `Реальный темплейт
       <https://github.com/mmskv/openstack-project-template>`_.

#. Создание :ref:`overlay-network` для своей виртуалочки:

   #. Project -> Networks -> Create Network. Имя можно любое.

   #. Дальше придумай любой CIDR для подсети. Лучше из приватных, но я тебе не мама.

   #. В DNS Name Servers и Host Routes ничего указывать не надо.

   #. Созданная подсеть сейчас просто болтается в воздухе. Чтобы из этой
         подсети можно было ходить в интернет нужно соединить её с нашей
         сетью, которая называется :ref:`public`, потому что на ней сетевики
         настроили SNAT. Соединяются сети при помощи роутеров (немного L3
         лора).

      TODO сюда бахнуть схему для понимания

      Протыкай Project -> Network -> Routers и создай новый роутер. В
      "External Network" должна стоять **provider**.

   #. **Теперь твою подсеть нужно подключить к новому роутеру.**

      Network -> Routers -> Тык на свой Router -> Interfaces -> Add Interface
      -> Выбираешь свою подсеть. Произошла коммутация.

#. Дальше нужно настроить фаервол, потому что по дефолту он запрещает весь
   входящий траффик. Настрой **default** :ref:`security-group` и разреши ICMP
   (ping) и SSH.

   #. Project -> Network -> Security Groups -> Manage Rules

   #. Rule -> Rule -> All ICMP -> ADD

   #. Rule -> Rule -> SSH -> ADD

#. Запуск Виртуалочки (:ref:`instance`)

   #. Compute -> Instances -> Launch Instance

   #. В описании напиши для чего тебе сервер, админам любопытно

   #. Выбери имадж (это как образ ОС, но там уже готовая система которая не требует ручной установки)

   #. Выбери :ref:`flavor`

   #. В Networks выбери свою новую сеть

   #. Security Groups пусть остаются на **default**

   #. В Key Pair импортируй свой SSH ключ или выбери из списка если уже импортировал

   #. Запускай Виртуалочку

   #. Прицепи Floating IP: Project -> Compute -> Instances -> В колонке *Actions* тык на стрелочку -> Associate Floating IP

   #. До IP, который ты только что прицепил к инстансу можно достучатся из мекстак впна. Но сначала его надо настроить

Мекстак впн
___________

ТЫК -> `vpnaas.mekstack.ru <https://vpnaas.mekstack.ru>`_.

Сгенерь приватный и публичный ключ, вставь в поле публичный, а в получившийся конфиг приватный и готово.

.. code::

    sudo wg-quick up ./wg0.conf # включить vpn
    sudo wg-quick down ./wg0.conf # выключить vpn

На `Arch Wiki написано <https://wiki.archlinux.org/title/WireGuard>`_ про Wireguard поподробнее.

Проверь работает ли впн

.. code::

    ping 172.18.218.2

Если работает, то ссшься в свой сервер и делай что хочешь.
Если не работает, то давай пиши нам в цулип бей тревогу.

Публикация сайтиков
___________________

Тяжело
